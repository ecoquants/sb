---
title: "AIA Charrette 2020 for Santa Barbara"
subtitle: "re invigorate, re invent, re imagine, re purpose"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, warning = F, message = F)
```

## Map

```{r}
source("functions.R")

area_plys <- get_area_plys()

leaflet() %>% 
  addProviderTiles(providers$Stamen.TonerLite, group = "Black & white",
    options = providerTileOptions(opacity = 0.5)) %>% 
  addProviderTiles(
    providers$CartoDB.Voyager, group = "Streets",
    options = providerTileOptions(opacity = 0.8)) %>%
  addProviderTiles(providers$Esri.WorldImagery, group = "Satellite",
    options = providerTileOptions(opacity = 0.5)) %>% 
  addPolygons(
    data = area_plys %>% 
      filter(layer == "Main Focus Areas"),
    group = "Main Focus Areas",
    color     = ~color, opacity     = 0.9, weight = 0.5,
    fillColor = ~color, fillOpacity = 0.6,
    label = ~area_name, popup = ~popup_html) %>%
  addPolygons(
    data = area_plys %>% 
      filter(layer == "Additional Focus Areas"),
    group = "Additional Focus Areas",
    color     = ~color, opacity     = 0.6, weight = 0.5,
    fillColor = ~color, fillOpacity = 0.3,
    label = ~area_name, popup = ~popup_html) %>%
  addLayersControl(
    baseGroups = c("Black & white", "Streets", "Satellite"),
    overlayGroups = c("Main Focus Areas", "Additional Focus Areas"),
    options = layersControlOptions(collapsed = FALSE))
```

## Projects

```{r}
projects <- read_csv(projects_csv) %>% 
  left_join(
    read_csv(teams_csv) %>% 
      select(team_key, team_htm),
    by = "team_key") %>% 
  mutate(
    Project = glue("<a href={project_htm}>{`Project Name`}</a>"), 
    Team    = glue("<a href={team_htm}>{team_name}</a>")) %>% 
  select(Area = area_name, Project, Team)

datatable(projects, escape = F)  
```
